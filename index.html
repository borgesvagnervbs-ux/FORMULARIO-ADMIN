<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Painel Admin - CNES</title>

  <!-- jQuery e jQuery Mask -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>

  <!-- Firebase v8 (compat) - MUST be loaded BEFORE firebase-config.js -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

  <link rel="stylesheet" href="admin.css" />
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="brand">CNES - Painel Admin</div>
      <nav>
        <ul>
          <li class="nav-item active" data-view="dashboard">Tela Principal</li>
          <li class="nav-item" data-view="reports">Relatórios</li>
        </ul>
      </nav>
      <div class="sidebar-footer">
        <small>Conectado ao Firestore</small>
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <h1 id="pageTitle">Tela Principal</h1>
        <div class="controls">
          <div class="status-tabs">
            <button class="tab-btn active" data-status="recebidos">Recebidos</button>
            <button class="tab-btn" data-status="editados">Editados</button>
            <button class="tab-btn" data-status="enviados">Enviados</button>
          </div>
        </div>
      </header>

      <!-- DASHBOARD / TELA PRINCIPAL -->
      <section id="dashboard" class="view">
        <div class="cards-container" id="cardsContainer">
          <!-- Cards serão renderizados aqui -->
        </div>
        <div id="emptyMessage" class="empty">Nenhum registro encontrado.</div>
      </section>

      <!-- REPORTS -->
      <section id="reports" class="view hidden">
        <div class="filters">
          <div class="filter-row">
            <input type="text" id="f_nome" placeholder="Nome" />
            <input type="text" id="f_cpf" placeholder="CPF (formato 000.000.000-00)" />
            <input type="text" id="f_estabelecimento" placeholder="Estabelecimento" />
            <input type="text" id="f_funcao" placeholder="Função / Especialidade" />
          </div>
          <div class="filter-row">
            <select id="f_ufConselho">
              <option value="">UF Conselho</option>
              <option>AC</option><option>AL</option><option>AP</option><option>AM</option><option>BA</option>
              <option>CE</option><option>DF</option><option>ES</option><option>GO</option><option>MA</option>
              <option>MT</option><option>MS</option><option>MG</option><option>PA</option><option>PB</option>
              <option>PR</option><option>PE</option><option>PI</option><option>RJ</option><option>RN</option>
              <option>RS</option><option>RO</option><option>RR</option><option>SC</option><option>SP</option>
              <option>SE</option><option>TO</option>
            </select>

            <select id="f_atendeSus">
              <option value="">Atende SUS?</option>
              <option value="Sim">Sim</option>
              <option value="Não">Não</option>
            </select>

            <select id="f_status">
              <option value="">Status</option>
              <option value="recebidos">recebidos</option>
              <option value="editados">editados</option>
              <option value="enviados">enviados</option>
            </select>

            <div class="date-range">
              <input type="date" id="f_dateFrom" />
              <input type="date" id="f_dateTo" />
            </div>
          </div>

          <div class="filter-actions">
            <button id="applyFilters" class="btn primary">Aplicar Filtros</button>
            <button id="clearFilters" class="btn">Limpar filtros</button>
            <div class="page-controls-right">
              <label>Mostrar
                <select id="perPage">
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              registros</label>
            </div>
          </div>
        </div>

        <div class="report-summary">
          <div>Total filtrado: <span id="totalFiltered">0</span></div>
        </div>

        <div class="table-wrap">
          <table id="resultsTable">
            <thead>
              <tr>
                <th>Data</th>
                <th>Nome</th>
                <th>CPF</th>
                <th>Estabelecimento</th>
                <th>Função</th>
                <th>UF Conselho</th>
                <th>Atende SUS</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody>
              <!-- Linhas de resultados -->
            </tbody>
          </table>
        </div>

        <div class="pagination">
          <button id="prevPage" class="btn">« Anterior</button>
          <span>Página <span id="currentPage">1</span> / <span id="totalPages">1</span></span>
          <button id="nextPage" class="btn">Próxima »</button>
        </div>
      </section>

      <!-- EDIT VIEW: tela inteira de edição (opção B) -->
      <section id="editView" class="view hidden">
        <div class="edit-container">
          <div class="edit-header">
            <button id="backToDashboard" class="btn">« Voltar</button>
            <h2>Editar Registro (Tela do Cliente)</h2>
            <div id="editMeta" class="meta small"></div>
          </div>

          <div class="edit-body">
            <form id="adminEditForm">
              <!-- Repliquei os principais campos do index.html, com prefixo "a_" -->
              <section class="form-section">
                <h4>DADOS DE IDENTIFICAÇÃO</h4>
                <div class="form-group full-width">
                    <label><span class="required">*</span>Nome do profissional:</label>
                    <input type="text" id="a_nome" name="nome" required>
                </div>
                <div class="form-group half-width">
                    <label><span class="required">*</span>CPF:</label>
                    <input type="text" id="a_cpf" name="cpf" required>
                </div>
                <div class="form-group half-width">
                    <label><span class="required">*</span>Data de nascimento:</label>
                    <input type="text" id="a_dataNascimento" name="dataNascimento" required placeholder="dd/mm/aaaa">
                </div>
                <div class="form-group full-width">
                    <label>Nome da mãe:</label>
                    <input type="text" id="a_nomeMae" name="nomeMae">
                </div>
                <div class="form-group smaller-width">
                    <label>Município de nascimento:</label>
                    <input type="text" id="a_municipioNascimento" name="municipioNascimento">
                </div>
                <div class="form-group mini-width">
                    <label>UF:</label>
                    <select id="a_ufNascimento" name="ufNascimento">
                        <option value="">UF</option>
                        <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                        <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                        <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                        <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                        <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                        <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                        <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                        <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                        <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                    </select>
                </div>
                <div class="form-group four-width">
                    <label>Identidade:</label>
                    <input type="text" id="a_identidade" name="identidade">
                </div>
                <div class="form-group four-width">
                    <label>UF Emissor:</label>
                    <select id="a_ufEmissorId" name="ufEmissorId">
                        <option value="">UF</option>
                        <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                        <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                        <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                        <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                        <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                        <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                        <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                        <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                        <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                    </select>
                </div>

                <div class="form-group half-width">
                    <label>Órgão emissor:</label>
                    <input type="text" id="a_orgaoEmissor" name="orgaoEmissor">
                </div>
                <div class="form-group half-width">
                    <label>Data da emissão:</label>
                    <input type="text" id="a_dataEmissao" name="dataEmissao" placeholder="dd/mm/aaaa">
                </div>
              </section>

              <section class="form-section">
                <h4>DADOS RESIDENCIAIS</h4>
                <div class="form-group two-thirds-width">
                    <label>Rua:</label>
                    <input type="text" id="a_rua" name="rua">
                </div>
                <div class="form-group one-third-width">
                    <label>Número:</label>
                    <input type="text" id="a_numero" name="numero">
                </div>
                <div class="form-group half-width">
                    <label>Complemento:</label>
                    <input type="text" id="a_complemento" name="complemento">
                </div>
                <div class="form-group half-width">
                    <label>Bairro/distrito:</label>
                    <input type="text" id="a_bairro" name="bairro">
                </div>
                <div class="form-group half-width">
                    <label>CEP:</label>
                    <div class="cep-group">
                        <input type="text" id="a_cep" name="cep">
                        <button type="button" id="a_btnBuscarCep" class="secondary-btn">Buscar CEP</button>
                    </div>
                </div>
                <div class="form-group half-width">
                    <label>Município:</label>
                    <input type="text" id="a_municipioResidencial" name="municipioResidencial">
                </div>
                <div class="form-group half-width">
                    <label>Telefone:</label>
                    <input type="text" id="a_telefone" name="telefone" placeholder="(XX) XXXXX-XXXX">
                </div>
                <div class="form-group half-width">
                    <label>E-mail:</label>
                    <input type="email" id="a_email" name="email">
                </div>
              </section>

              <section class="form-section">
                <h4>DADOS PROFISSIONAIS</h4>
                <div class="form-group two-thirds-width">
                    <label><span class="required">*</span>Estabelecimento:</label>
                    <input type="text" id="a_estabelecimento" name="estabelecimento" required>
                </div>
                <div class="form-group one-third-width">
                    <label><span class="required">*</span>Data de início na unidade de saúde:</label>
                    <input type="text" id="a_dataInicio" name="dataInicio" required placeholder="dd/mm/aaaa">
                </div>
                <div class="form-group quarter-width">
                    <label><span class="required">*</span>Carga horária semanal:</label>
                    <input type="number" id="a_cargaHoraria" name="cargaHoraria" min="1" required>
                </div>
                <div class="form-group half-width">
                    <label><span class="required">*</span>Função/Especialidade/CBO:</label>
                    <input type="text" id="a_funcao" name="funcao" required>
                </div>
                <div class="form-group three-quarters-width">
                    <label>Escolaridade:</label>
                    <select id="a_escolaridade" name="escolaridade">
                        <option value="">Selecione a Escolaridade</option>
                        <option value="Fundamental Incompleto">Fundamental Incompleto</option>
                        <option value="Fundamental Completo">Fundamental Completo</option>
                        <option value="Médio Incompleto">Médio Incompleto</option>
                        <option value="Médio Completo">Médio Completo</option>
                        <option value="Superior Incompleto">Superior Incompleto</option>
                        <option value="Superior Completo">Superior Completo</option>
                        <option value="Pós-Graduação">Pós-Graduação</option>
                        <option value="Mestrado">Mestrado</option>
                        <option value="Doutorado">Doutorado</option>
                    </select>
                </div>
                <div class="form-group three-eighths-width">
                    <label><span class="required">*</span>Número do registro no conselho de classe:</label>
                    <input type="text" id="a_registroConselho" name="registroConselho" required>
                </div>
                <div class="form-group one-eighth-width">
                    <label>UF Conselho:</label>
                    <select id="a_ufConselho" name="ufConselho">
                        <option value="">UF</option>
                        <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option>
                        <option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option>
                        <option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option>
                        <option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option>
                        <option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option>
                        <option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option>
                        <option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option>
                        <option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option>
                        <option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                    </select>
                </div>

                <div class="form-group radio-group full-width">
                    <label><span class="required">*</span>VÍNCULO COM O ESTABELECIMENTO:</label>
                    <div class="vinculo-group">
                        <div class="sub-group">
                            <input type="radio" id="a_vinculo_clt" name="a_vinculoEstabelecimento" value="CLT" required>
                            <label for="a_vinculo_clt">CLT</label>
                            <input type="radio" id="a_vinculo_terceirizado" name="a_vinculoEstabelecimento" value="Terceirizado">
                            <label for="a_vinculo_terceirizado">Terceirizado</label>
                            <input type="radio" id="a_vinculo_contratoEmergencial" name="a_vinculoEstabelecimento" value="Contrato Emergencial">
                            <label for="a_vinculo_contratoEmergencial">Contrato Emergencial</label>
                            <input type="radio" id="a_vinculo_processoSeletivo" name="a_vinculoEstabelecimento" value="Processo Seletivo">
                            <label for="a_vinculo_processoSeletivo">Processo Seletivo</label>
                            <input type="radio" id="a_vinculoEstabelecimento_estatutario" name="a_vinculoEstabelecimento" value="Estatutário" required>
                            <label for="a_vinculoEstabelecimento_estatutario">Estatutário</label>
                            <input type="radio" id="a_vinculoEstabelecimento_autonomo" name="a_vinculoEstabelecimento" value="Autônomo">
                            <label for="a_vinculoEstabelecimento_autonomo">Autônomo</label>
                            <input type="radio" id="a_vinculoEstabelecimento_residente" name="a_vinculoEstabelecimento" value="Residente">
                            <label for="a_vinculoEstabelecimento_residente">Residente</label>
                            <input type="radio" id="a_vinculoEstabelecimento_estagiario" name="a_vinculoEstabelecimento" value="Estagiário">
                            <label for="a_vinculoEstabelecimento_estagiario">Estagiário</label>
                        </div>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label>Informar a empresa/local/instituição que tem o vínculo:</label>
                    <input type="text" id="a_empresaVinculo" name="empresaVinculo" placeholder="Nome da Empresa">
                </div>
                <div class="form-group full-width">
                    <label>CNPJ:</label>
                    <input type="text" id="a_CNPJ" name="CNPJ" placeholder="00.000.000/0000-00">
                </div>

                <div class="form-group radio-group atende-sus-group">
                    <label>Atende SUS:</label>
                    <div class="atende-sus-options">
                        <label for="a_atendeSus_sim">Sim</label>
                        <input type="radio" id="a_atendeSus_sim" name="a_atendeSus" value="Sim">
                    </div>
                    <div class="atende-sus-options">
                        <label for="a_atendeSus_nao">Não</label>
                        <input type="radio" id="a_atendeSus_nao" name="a_atendeSus" value="Não">
                    </div>
                </div>
              </section>

              <p class="nota">**Todos os campos com <span class="required">*</span> são obrigatórios.</p>

              <div class="modal-actions" style="margin-top:18px;">
                <button type="button" id="saveAsEdited" class="btn primary">Salvar como EDITADO</button>
                <button type="button" id="saveAsSent" class="btn">Salvar como ENVIADO</button>
                <button type="button" id="cancelEditFull" class="btn">Cancelar</button>
              </div>
            </form>
            <div id="adminEditMessage" class="hidden" style="margin-top:12px;"></div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Nosso arquivo que inicializa o Firebase e expõe cnesCollection -->
  <script src="firebase-config.js"></script>

  <!-- Script do admin (entregue abaixo como admin.js) -->
  <script src="admin.js"></script>
</body>
</html>
